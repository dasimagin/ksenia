2019-05-17 11:01:53,615:INFO: Loaded config
2019-05-17 11:01:53,616:INFO: ('name', 'Copy Q-learning NTM')
2019-05-17 11:01:53,616:INFO: ('seed', 1)
2019-05-17 11:01:53,616:INFO: ('gpu', True)
2019-05-17 11:01:53,616:INFO: ('task', {'name': 'copy', 'len_alphabet': 5, 'min_len': 1, 'max_len': 20, 'n_copies': 1, 'update_limit': 1.0, 'min_update_iters': 75})
2019-05-17 11:01:53,616:INFO: ('model', {'name': 'dntm', 'mem_word_length': 5, 'mem_cells_count': 128, 'n_writes': 1, 'n_reads': 1, 'controller_n_hidden': 256, 'controller_n_layers': 1, 'controller_clip': 20})
2019-05-17 11:01:53,616:INFO: ('train', {'checkpoint_interval': 1000, 'report_interval': 100, 'verbose_interval': 25, 'train_iterations': 18000, 'update_interval': 3, 'batch_size': 64, 'loss': 'mse'})
2019-05-17 11:01:53,616:INFO: ('q_learning', {'gamma': 0.999, 'alpha': 0.1, 'eps_start': 0.9, 'eps_restart': 0.15, 'eps_end': 0.05, 'eps_decay': 150})
2019-05-17 11:01:53,616:INFO: ('validation', {'iterations': 5, 'len_val_seqs': [25, 50, 75, 100, 150]})
2019-05-17 11:01:53,616:INFO: ('optim', {'optimizer': 'adam', 'learning_rate': 0.0001, 'momentum': 0.9, 'gradient_clipping': 15.0})
2019-05-17 11:01:53,616:INFO: ('path', PosixPath('experiments/copy_dntm'))
2019-05-17 11:01:53,616:INFO: ('tensorboard', PosixPath('experiments/copy_dntm/tensorboard'))
2019-05-17 11:01:53,616:INFO: ('checkpoints', PosixPath('experiments/copy_dntm/checkpoints'))
2019-05-17 11:01:53,616:INFO: Start training
2019-05-17 11:02:06,535:INFO: Loaded model
2019-05-17 11:02:06,539:INFO: Total number of parameters 286033
2019-05-17 11:02:06,612:INFO: Generating grammar tables from /usr/lib/python3.6/lib2to3/Grammar.txt
2019-05-17 11:02:06,708:INFO: Generating grammar tables from /usr/lib/python3.6/lib2to3/PatternGrammar.txt
2019-05-17 11:02:12,724:INFO: Sequences: 0, Mean episode_total_rewards: -0.007556175595238096, loss_avg: 0.00017311939969658852, epsilon: 0.9 curr_temp_size: 1 (237.63 ms/iter)
2019-05-17 11:02:12,724:INFO: Validating model on same-size sequences
2019-05-17 11:02:13,455:INFO: Validating model on longer sequences
2019-05-17 11:03:15,909:INFO: Validating model on same-size sequences
2019-05-17 11:03:40,480:INFO: Validating model on same-size sequences
2019-05-17 11:04:03,155:INFO: Validating model on same-size sequences
2019-05-17 11:04:26,546:INFO: Validating model on same-size sequences
2019-05-17 11:04:49,128:INFO: Validating model on same-size sequences
2019-05-17 11:05:11,778:INFO: Validating model on same-size sequences
2019-05-17 11:05:28,774:INFO: Validating model on same-size sequences
2019-05-17 11:05:49,385:INFO: Validating model on same-size sequences
2019-05-17 11:05:55,973:INFO: Sequences: 1600, Mean episode_total_rewards: -0.006314903846153847, loss_avg: 0.00016287466511130333, epsilon: 0.8504998535466114 curr_temp_size: 1 (8929.94 ms/iter)
2019-05-17 11:06:10,617:INFO: Validating model on same-size sequences
2019-05-17 11:06:37,864:INFO: Validating model on same-size sequences
2019-05-17 11:07:02,187:INFO: Validating model on same-size sequences
2019-05-17 11:07:24,724:INFO: Validating model on same-size sequences
2019-05-17 11:07:45,695:INFO: Validating model on same-size sequences
2019-05-17 11:08:02,922:INFO: Validating model on same-size sequences
2019-05-17 11:08:23,590:INFO: Validating model on same-size sequences
2019-05-17 11:08:44,109:INFO: Validating model on same-size sequences
2019-05-17 11:09:00,242:INFO: Sequences: 3200, Mean episode_total_rewards: -0.010040489994074553, loss_avg: 0.000131396958604455, epsilon: 0.8089250439167868 curr_temp_size: 1 (7370.76 ms/iter)
2019-05-17 11:09:06,814:INFO: Validating model on same-size sequences
2019-05-17 11:09:26,244:INFO: Validating model on same-size sequences
2019-05-17 11:09:46,035:INFO: Validating model on same-size sequences
2019-05-17 11:10:07,152:INFO: Validating model on same-size sequences
2019-05-17 11:10:31,554:INFO: Validating model on same-size sequences
2019-05-17 11:10:52,891:INFO: Validating model on same-size sequences
2019-05-17 11:11:13,617:INFO: Validating model on same-size sequences
2019-05-17 11:11:34,278:INFO: Validating model on same-size sequences
2019-05-17 11:11:55,285:INFO: Sequences: 4800, Mean episode_total_rewards: -0.007863433441558442, loss_avg: 0.0001484481245279312, epsilon: 0.769509466157022 curr_temp_size: 1 (7001.75 ms/iter)
2019-05-17 11:11:55,288:INFO: Validating model on same-size sequences
2019-05-17 11:12:13,423:INFO: Validating model on same-size sequences
2019-05-17 11:12:32,425:INFO: Validating model on same-size sequences
2019-05-17 11:12:50,815:INFO: Validating model on same-size sequences
2019-05-17 11:13:12,425:INFO: Validating model on same-size sequences
2019-05-17 11:13:32,656:INFO: Validating model on same-size sequences
2019-05-17 11:13:53,441:INFO: Validating model on same-size sequences
2019-05-17 11:14:13,789:INFO: Validating model on same-size sequences
2019-05-17 11:14:33,905:INFO: Validating model on same-size sequences
2019-05-17 11:14:41,054:INFO: Sequences: 6400, Mean episode_total_rewards: -0.004671949760765549, loss_avg: 0.0001711287908256054, epsilon: 0.7276084968048195 curr_temp_size: 1 (6630.73 ms/iter)
2019-05-17 11:14:41,054:INFO: Validating model on longer sequences
2019-05-17 11:15:31,410:INFO: Validating model on same-size sequences
2019-05-17 11:15:53,764:INFO: Validating model on same-size sequences
2019-05-17 11:16:14,670:INFO: Validating model on same-size sequences
2019-05-17 11:16:34,792:INFO: Validating model on same-size sequences
2019-05-17 11:16:51,524:INFO: Validating model on same-size sequences
2019-05-17 11:17:13,787:INFO: Validating model on same-size sequences
2019-05-17 11:17:33,465:INFO: Validating model on same-size sequences
2019-05-17 11:17:50,814:INFO: Validating model on same-size sequences
2019-05-17 11:18:09,417:INFO: Sequences: 8000, Mean episode_total_rewards: -0.00693829472578505, loss_avg: 0.00015585277229547502, epsilon: 0.6924161802373666 curr_temp_size: 1 (8334.46 ms/iter)
2019-05-17 11:18:19,485:INFO: Validating model on same-size sequences
2019-05-17 11:18:45,434:INFO: Validating model on same-size sequences
2019-05-17 11:19:08,706:INFO: Validating model on same-size sequences
2019-05-17 11:19:34,949:INFO: Validating model on same-size sequences
2019-05-17 11:19:56,356:INFO: Validating model on same-size sequences
2019-05-17 11:20:19,857:INFO: Validating model on same-size sequences
2019-05-17 11:20:41,948:INFO: Validating model on same-size sequences
2019-05-17 11:21:06,020:INFO: Validating model on same-size sequences
2019-05-17 11:21:27,891:INFO: Sequences: 9600, Mean episode_total_rewards: 0.0007331495098039212, loss_avg: 0.00018835579976439476, epsilon: 0.6590516139877209 curr_temp_size: 1 (7939.05 ms/iter)
2019-05-17 11:21:27,891:INFO: Validating model on same-size sequences
2019-05-17 11:21:48,983:INFO: Validating model on same-size sequences
2019-05-17 11:22:11,000:INFO: Validating model on same-size sequences
2019-05-17 11:22:30,635:INFO: Validating model on same-size sequences
2019-05-17 11:22:50,380:INFO: Validating model on same-size sequences
2019-05-17 11:23:10,190:INFO: Validating model on same-size sequences
2019-05-17 11:23:32,136:INFO: Validating model on same-size sequences
2019-05-17 11:23:52,967:INFO: Validating model on same-size sequences
2019-05-17 11:24:16,976:INFO: Validating model on same-size sequences
2019-05-17 11:24:25,434:INFO: Sequences: 11200, Mean episode_total_rewards: 2.3085056390977425e-05, loss_avg: 0.00018561812117695809, epsilon: 0.6235832091758798 curr_temp_size: 1 (7101.71 ms/iter)
2019-05-17 11:24:40,121:INFO: Validating model on same-size sequences
2019-05-17 11:25:02,784:INFO: Validating model on same-size sequences
2019-05-17 11:25:26,189:INFO: Validating model on same-size sequences
2019-05-17 11:25:47,175:INFO: Validating model on same-size sequences
2019-05-17 11:26:08,953:INFO: Validating model on same-size sequences
2019-05-17 11:26:36,813:INFO: Validating model on same-size sequences
2019-05-17 11:26:59,788:INFO: Validating model on same-size sequences
2019-05-17 11:27:22,834:INFO: Validating model on same-size sequences
2019-05-17 11:27:41,617:INFO: Sequences: 12800, Mean episode_total_rewards: 0.0028802083333333336, loss_avg: 0.0001746479421854019, epsilon: 0.5937935563449658 curr_temp_size: 1 (7847.32 ms/iter)
2019-05-17 11:27:41,617:INFO: Validating model on longer sequences
2019-05-17 11:29:04,612:INFO: Validating model on same-size sequences
2019-05-17 11:29:29,502:INFO: Validating model on same-size sequences
2019-05-17 11:29:57,668:INFO: Validating model on same-size sequences
2019-05-17 11:30:19,099:INFO: Validating model on same-size sequences
2019-05-17 11:30:42,492:INFO: Validating model on same-size sequences
2019-05-17 11:31:04,841:INFO: Validating model on same-size sequences
2019-05-17 11:31:31,275:INFO: Validating model on same-size sequences
2019-05-17 11:31:56,066:INFO: Validating model on same-size sequences
2019-05-17 11:32:32,348:INFO: Sequences: 14400, Mean episode_total_rewards: 0.0031555735930735925, loss_avg: 0.00019723065197467803, epsilon: 0.5655510607557385 curr_temp_size: 1 (11629.25 ms/iter)
2019-05-17 11:32:32,348:INFO: Validating model on same-size sequences
2019-05-17 11:33:10,651:INFO: Validating model on same-size sequences
2019-05-17 11:33:49,345:INFO: Validating model on same-size sequences
2019-05-17 11:34:14,636:INFO: Validating model on same-size sequences
2019-05-17 11:34:39,743:INFO: Validating model on same-size sequences
2019-05-17 11:35:09,578:INFO: Validating model on same-size sequences
2019-05-17 11:35:39,308:INFO: Validating model on same-size sequences
2019-05-17 11:36:16,518:INFO: Validating model on same-size sequences
2019-05-17 11:36:46,138:INFO: Validating model on same-size sequences
2019-05-17 11:37:00,322:INFO: Sequences: 16000, Mean episode_total_rewards: 0.0164800733805668, loss_avg: 0.00015118696726858615, epsilon: 0.14480639384933955 curr_temp_size: 2 (10718.97 ms/iter)
2019-05-17 11:37:16,433:INFO: Validating model on same-size sequences
2019-05-17 11:37:45,581:INFO: Validating model on same-size sequences
2019-05-17 11:38:20,449:INFO: Validating model on same-size sequences
2019-05-17 11:38:50,272:INFO: Validating model on same-size sequences
2019-05-17 11:39:17,301:INFO: Validating model on same-size sequences
2019-05-17 11:39:47,309:INFO: Validating model on same-size sequences
2019-05-17 11:40:17,577:INFO: Validating model on same-size sequences
2019-05-17 11:40:47,605:INFO: Validating model on same-size sequences
2019-05-17 11:41:08,985:INFO: Sequences: 17600, Mean episode_total_rewards: 0.00989783653846154, loss_avg: 0.00016135670244693756, epsilon: 0.13988252314716088 curr_temp_size: 2 (9946.52 ms/iter)
2019-05-17 11:41:21,417:INFO: Validating model on same-size sequences
2019-05-17 11:41:39,296:INFO: Validating model on same-size sequences
2019-05-17 11:41:56,447:INFO: Validating model on same-size sequences
2019-05-17 11:42:16,035:INFO: Validating model on same-size sequences
2019-05-17 11:42:36,780:INFO: Validating model on same-size sequences
2019-05-17 11:42:52,028:INFO: Validating model on same-size sequences
2019-05-17 11:43:09,018:INFO: Validating model on same-size sequences
2019-05-17 11:43:29,263:INFO: Validating model on same-size sequences
2019-05-17 11:43:48,547:INFO: Sequences: 19200, Mean episode_total_rewards: 0.017552369505494506, loss_avg: 0.00013703119941055775, epsilon: 0.13521437889662113 curr_temp_size: 2 (6382.46 ms/iter)
2019-05-17 11:43:48,547:INFO: Validating model on same-size sequences
2019-05-17 11:43:50,853:INFO: Validating model on longer sequences
2019-05-17 11:44:34,029:INFO: Validating model on same-size sequences
2019-05-17 11:44:53,764:INFO: Validating model on same-size sequences
2019-05-17 11:45:14,202:INFO: Validating model on same-size sequences
2019-05-17 11:45:34,234:INFO: Validating model on same-size sequences
2019-05-17 11:45:52,651:INFO: Validating model on same-size sequences
2019-05-17 11:46:13,040:INFO: Validating model on same-size sequences
2019-05-17 11:46:36,814:INFO: Validating model on same-size sequences
2019-05-17 11:46:55,920:INFO: Validating model on same-size sequences
2019-05-17 11:47:04,984:INFO: Sequences: 20800, Mean episode_total_rewards: 0.018433177958683475, loss_avg: 0.00012719785794615746, epsilon: 0.13025187979624786 curr_temp_size: 2 (7857.47 ms/iter)
2019-05-17 11:47:16,707:INFO: Validating model on same-size sequences
2019-05-17 11:47:39,312:INFO: Validating model on same-size sequences
2019-05-17 11:47:59,351:INFO: Validating model on same-size sequences
2019-05-17 11:48:18,781:INFO: Validating model on same-size sequences
2019-05-17 11:48:38,755:INFO: Validating model on same-size sequences
2019-05-17 11:49:04,941:INFO: Validating model on same-size sequences
2019-05-17 11:49:31,548:INFO: Validating model on same-size sequences
2019-05-17 11:49:54,534:INFO: Validating model on same-size sequences
2019-05-17 11:50:13,044:INFO: Sequences: 22400, Mean episode_total_rewards: 0.021834857028935978, loss_avg: 0.00011637741699814797, epsilon: 0.12608391323112927 curr_temp_size: 2 (7522.43 ms/iter)
2019-05-17 11:50:17,919:INFO: Validating model on same-size sequences
2019-05-17 11:50:39,467:INFO: Validating model on same-size sequences
2019-05-17 11:50:57,317:INFO: Validating model on same-size sequences
2019-05-17 11:51:13,638:INFO: Validating model on same-size sequences
2019-05-17 11:51:34,524:INFO: Validating model on same-size sequences
2019-05-17 11:51:52,761:INFO: Validating model on same-size sequences
2019-05-17 11:52:11,415:INFO: Validating model on same-size sequences
2019-05-17 11:52:29,081:INFO: Validating model on same-size sequences
2019-05-17 11:52:47,609:INFO: Sequences: 24000, Mean episode_total_rewards: 0.02143863038003663, loss_avg: 0.00013658829964697362, epsilon: 0.12213241443389419 curr_temp_size: 2 (6182.58 ms/iter)
2019-05-17 11:52:47,609:INFO: Validating model on same-size sequences
2019-05-17 11:53:02,523:INFO: Validating model on same-size sequences
2019-05-17 11:53:18,319:INFO: Validating model on same-size sequences
2019-05-17 11:53:35,159:INFO: Validating model on same-size sequences
2019-05-17 11:53:50,305:INFO: Validating model on same-size sequences
2019-05-17 11:54:04,469:INFO: Validating model on same-size sequences
2019-05-17 11:54:25,035:INFO: Validating model on same-size sequences
2019-05-17 11:54:43,739:INFO: Validating model on same-size sequences
2019-05-17 11:55:00,086:INFO: Validating model on same-size sequences
2019-05-17 11:55:07,653:INFO: Sequences: 25600, Mean episode_total_rewards: 0.025062624601275917, loss_avg: 0.00015123171731829644, epsilon: 0.1179317496356421 curr_temp_size: 2 (5601.75 ms/iter)
2019-05-17 11:55:07,653:INFO: Validating model on longer sequences
2019-05-17 11:55:43,881:INFO: Validating model on same-size sequences
2019-05-17 11:56:01,888:INFO: Validating model on same-size sequences
2019-05-17 11:56:21,471:INFO: Validating model on same-size sequences
2019-05-17 11:56:38,500:INFO: Validating model on same-size sequences
2019-05-17 11:56:56,036:INFO: Validating model on same-size sequences
2019-05-17 11:57:11,296:INFO: Validating model on same-size sequences
2019-05-17 11:57:28,314:INFO: Validating model on same-size sequences
2019-05-17 11:57:44,081:INFO: Validating model on same-size sequences
2019-05-17 11:57:56,067:INFO: Sequences: 27200, Mean episode_total_rewards: 0.030610363800125315, loss_avg: 0.000125868683680892, epsilon: 0.11440364210831414 curr_temp_size: 2 (6736.56 ms/iter)
2019-05-17 11:58:00,282:INFO: Validating model on same-size sequences
2019-05-17 11:58:18,557:INFO: Validating model on same-size sequences
2019-05-17 11:58:34,874:INFO: Validating model on same-size sequences
2019-05-17 11:58:51,977:INFO: Validating model on same-size sequences
2019-05-17 11:59:10,306:INFO: Validating model on same-size sequences
2019-05-17 11:59:29,490:INFO: Validating model on same-size sequences
2019-05-17 11:59:47,468:INFO: Validating model on same-size sequences
2019-05-17 12:00:08,540:INFO: Validating model on same-size sequences
2019-05-17 12:00:28,168:INFO: Sequences: 28800, Mean episode_total_rewards: 0.03053125, loss_avg: 0.00012287813238799573, epsilon: 0.11105877059052738 curr_temp_size: 2 (6084.07 ms/iter)
2019-05-17 12:00:28,169:INFO: Validating model on same-size sequences
2019-05-17 12:00:46,857:INFO: Validating model on same-size sequences
